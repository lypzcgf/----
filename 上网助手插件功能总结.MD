# 上网助手插件功能总结

## 项目概述

上网助手是一个基于Chrome扩展的智能文本处理工具，主要提供网页文本翻译和改写功能。插件采用Manifest V3架构，集成了多个主流大模型API，为用户提供高质量的文本处理服务。

## 核心功能

### 1. 智能翻译功能

#### 支持的大模型
- **Kimi (月之暗面)**: 使用moonshot-v1-8k模型
- **DeepSeek**: 使用deepseek-chat模型  
- **Qwen (通义千问)**: 使用qwen-turbo模型
- **Doubao (豆包)**: 支持自定义模型端点

#### 翻译特性
- 支持多语言互译（中文、英文、西班牙语等）
- 自动语言检测功能
- 实时翻译统计信息（字符数、词数、段落数、行数、翻译时间）
- 带重试机制的API调用（支持429错误重试）
- 翻译结果一键复制功能

### 2. 文本改写功能

#### 改写特性
- 支持自定义改写提示词
- 使用相同的大模型进行文本改写
- 改写统计信息（原文字符数、改写后字符数、改写时间）
- 改写结果一键复制功能

### 3. 网页文本获取功能

#### 文本选择方式
- **选中文本获取**: 实时监听用户在网页上的文本选择
- **全文获取**: 智能提取网页主要内容（支持article、main、content等标签）
- **自动同步**: 选中文本自动同步到插件界面

#### 文本处理
- 自动过滤脚本、样式、导航等无关元素
- 支持多种网页结构的内容提取
- 实时文本选择变化监听

### 4. 飞书多维表格数据同步

#### 同步功能
- 翻译记录自动同步到飞书多维表格
- 改写记录自动同步到飞书多维表格
- 支持分别配置翻译和改写数据表

#### 同步数据字段
- 原文内容、操作类型、操作时间
- 使用模型、页面URL、页面标题
- 翻译结果/改写结果
- 源语言、目标语言（翻译）
- 改写提示词（改写）
- 同步时间、最后修改时间

### 5. 大模型配置管理

#### 配置项
- API Key管理（支持多个模型的独立配置）
- Base URL自定义（支持私有部署）
- 模型端点配置
- 连接测试功能

#### 配置特性
- 本地安全存储
- 实时配置验证
- 默认配置自动填充

## 技术架构

### 扩展架构
- **Manifest Version**: 3
- **架构模式**: Service Worker + Content Scripts + Side Panel

### 核心组件

#### 1. Background Service Worker (background.js)
- 统一的消息处理中心
- 大模型API调用管理
- 数据存储管理
- 飞书API集成

#### 2. Content Scripts (content.js)
- 网页文本选择监听
- 页面内容提取
- 与插件界面的消息传递

#### 3. Side Panel (sidebar.html/js)
- 主要用户界面
- 功能配置管理
- 结果展示和交互

#### 4. Popup (popup.html/js)
- 快速翻译入口
- 侧边栏启动器

### API集成

#### 大模型API
- 统一的OpenAI兼容接口调用
- 不同模型的特殊参数适配
- 错误处理和重试机制

#### 飞书API
- 租户访问令牌获取
- 多维表格数据写入
- 连接测试和验证

## 用户界面

### 侧边栏界面
- **大模型配置区**: 模型选择、API Key配置、连接测试
- **网页原文区**: 文本获取、显示、复制、清空
- **翻译功能区**: 语言选择、翻译执行、结果展示、统计信息
- **改写功能区**: 提示词编辑、改写执行、结果展示、统计信息
- **飞书配置区**: 应用配置、表格配置、连接测试
- **数据同步区**: 翻译记录同步、改写记录同步

### 弹出窗口界面
- 简化的翻译功能入口
- 一键启动侧边栏

## 权限配置

### Chrome权限
- `activeTab`: 访问当前活动标签页
- `scripting`: 注入内容脚本
- `storage`: 本地数据存储
- `sidePanel`: 侧边栏功能

### 主机权限
- `https://api.moonshot.cn/*`: Kimi API访问
- `https://dashscope.aliyuncs.com/*`: Qwen API访问
- `https://open.feishu.cn/*`: 飞书API访问
- `<all_urls>`: 全网页访问（用于内容提取）

## 使用流程

### 翻译流程
1. 配置大模型API Key
2. 在网页上选择需要翻译的文本
3. 打开插件侧边栏
4. 选择源语言和目标语言
5. 点击翻译按钮
6. 查看翻译结果和统计信息
7. 可选择复制结果或同步到飞书

### 改写流程
1. 配置大模型API Key
2. 在网页上选择需要改写的文本
3. 打开插件侧边栏
4. 编辑改写提示词
5. 点击改写按钮
6. 查看改写结果和统计信息
7. 可选择复制结果或同步到飞书

## 特色功能

### 1. 多模型支持
- 支持4种主流大模型
- 统一的配置和调用接口
- 灵活的模型切换

### 2. 智能文本处理
- 自动文本选择监听
- 智能网页内容提取
- 实时界面同步

### 3. 数据管理
- 本地安全存储
- 飞书云端同步
- 完整的操作记录

### 4. 用户体验
- 直观的侧边栏界面
- 实时统计信息
- 一键复制功能
- 连接状态测试

## 技术特点

### 1. 现代化架构
- Manifest V3兼容
- Service Worker架构
- 模块化设计

### 2. 可扩展性
- 统一的大模型接口
- 插件化的功能模块
- 灵活的配置系统

### 3. 稳定性
- 错误处理机制
- API重试策略
- 扩展上下文检查

### 4. 安全性
- 本地API Key存储
- 安全的消息传递
- 权限最小化原则

## 开发状态

当前插件已实现核心的翻译和改写功能，支持多种大模型，具备完整的用户界面和数据同步功能。根据开发计划文档，插件正在向更加综合的上网助手工具发展，未来可能会增加更多的文本处理功能。

## 总结

上网助手插件是一个功能完善的文本处理工具，通过集成多个大模型API，为用户提供了高质量的翻译和改写服务。插件采用现代化的Chrome扩展架构，具有良好的用户体验和可扩展性，是一个实用的网页文本处理助手。