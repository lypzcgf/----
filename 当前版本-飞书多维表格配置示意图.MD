# 当前版本-飞书多维表格配置示意图

## 设计理念

将飞书多维表格配置功能整合到当前最新版本的上网助手界面中，作为大模型配置区域的扩展功能。保持界面的一致性和用户体验的流畅性，同时提供清晰的功能分区。

## UI布局设计

### 主要功能区域

1. **大模型配置区域**
   - 大模型选择下拉菜单
   - 支持多种大模型的API Key配置
   - 模型参数设置（Base URL、模型端点等）
   - 当前模型状态指示器

2. **飞书多维表格配置区域**
   - 飞书多维表格同步开关
   - 飞书应用配置参数（飞书应用ID、飞书应用密钥、多维表格Token）
   - 连接测试和状态显示

3. **网页原文区域**
   - 显示从网页中选中的原始文本
   - 提供复制原文功能

4. **功能切换区域**
   - 翻译/改写功能切换标签页
   - 保持界面简洁，避免功能混乱

5. **翻译功能区域**
   - 源语言和目标语言选择
   - 翻译操作按钮
   - 翻译结果显示
   - 翻译统计信息

6. **改写功能区域**
   - 改写提示词编辑框
   - 改写操作按钮
   - 改写结果显示
   - 改写统计信息

### 界面布局草图

```
+--------------------------------------------------+
| 上网助手                                         |
+--------------------------------------------------+
| 大模型配置区域:                                  |
| 大模型: [下拉菜单 ▼]                             |
| [Kimi] [DeepSeek] [Qwen] [Doubao]               |
|                                                  |
| API Key: [密码输入框]                           |
| Base URL: [文本输入框]                          |
| 模型端点: [文本输入框]                          |
|                                                  |
| [保存] [测试连接] [开启调试] [导出日志]         |
+--------------------------------------------------+
| 飞书多维表格配置区域:                            |
|                                                  |
| 飞书应用ID: [文本输入框]                         |
| 飞书应用密钥: [密码输入框]                       |
| 多维表格Token: [文本输入框]                      |
|                                                  |
| [保存配置] [测试连接]                           |
+--------------------------------------------------+
| 网页原文                                         |
| [选中的文本内容显示区域]                        |
| [获取选中文字] [获取全文] [📋 复制原文] [🗑️ 清空] |
+--------------------------------------------------+
| [翻译] [改写]                                    |
+--------------------------------------------------+
| 翻译功能区域:                                    |
| 源语言: [下拉菜单 ▼]  目标语言: [下拉菜单 ▼]    |
|                                                  |
| [🔄 开始翻译]                                   |
|                                                  |
| 翻译结果:                                        |
| [翻译后的文本内容显示区域]                      |
| [📋 复制译文]                                    |
|                                                  |
| 统计信息:                                        |
| 翻译时间: XX秒  字符数: XX  单词数: XX          |
+--------------------------------------------------+
| 改写功能区域:                                    |
| [提示词编辑框                                    |
|  请将以下文本改写得更加正式和专业               |
|  要求：                                          |
|  1. 保持原意不变                                 |
|  2. 使用正式的商务语言                           |
|  3. 适当扩展内容以增强表达力]                    |
|                                                  |
| [🔄 开始改写]                                   |
|                                                  |
| 改写结果:                                        |
| [改写后的文本内容显示区域]                      |
| [📋 复制改写结果]                                |
|                                                  |
| 统计信息:                                        |
| 改写时间: XX秒  原字符数: XX  改写后字符数: XX  |
+--------------------------------------------------+
```

## 功能交互设计

### 核心交互流程

1. 用户配置大模型参数并测试连接
2. 用户可选择是否启用飞书多维表格同步功能
3. 若启用同步功能，用户配置飞书相关参数并测试连接
4. 用户在网页中选择需要处理的文本
5. 选中文本自动同步到插件的"网页原文"区域
6. 用户选择使用翻译功能还是改写功能
7. 根据选择的功能进行相应操作：
   - 翻译功能：选择源语言、目标语言，点击"开始翻译"
   - 改写功能：编辑提示词，点击"开始改写"
8. 处理结果在对应区域显示
9. 若启用飞书同步，处理结果自动同步到飞书多维表格
10. 用户可以复制原文、译文或改写结果

### 特色功能

1. **统一配置管理**: 大模型配置和飞书多维表格配置分区域管理，界面清晰
2. **功能开关**: 飞书同步功能可通过开关控制启用或禁用
3. **状态可视化**: 显示大模型和飞书连接状态
4. **操作便捷**: 提供测试连接按钮，方便用户验证配置
5. **数据管理**: 提供查看同步记录功能，方便用户管理已同步数据

## 技术实现考虑

### 功能模块化设计

1. **配置模块**: 管理大模型和飞书多维表格配置信息
2. **文本处理模块**: 负责文本选择、同步和显示
3. **翻译模块**: 实现文本翻译功能
4. **改写模块**: 实现文本改写功能
5. **同步模块**: 实现与飞书多维表格的数据同步
6. **UI模块**: 负责界面展示和用户交互

### 与现有功能的整合

1. 复用现有的文本选择和同步机制
2. 保持一致的UI风格和交互体验
3. 共享相同的API调用基础架构
4. 统一的配置管理机制
5. 飞书同步功能作为可选扩展，不影响核心功能使用

## 用户体验优化

1. **直观的操作界面**: 简洁明了的布局，将配置区域放在界面顶端
2. **功能明确分区**: 通过区域划分明确区分不同配置功能
3. **状态可视化**: 通过状态指示器显示连接状态
4. **即时反馈**: 操作后立即显示结果，提供流畅的使用体验
5. **个性化设置**: 允许用户根据需要启用或禁用飞书同步功能
6. **清晰的指引**: 提供必要的使用说明和示例